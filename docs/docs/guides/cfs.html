<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/cfs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">COSMOS and NASA cFS | OpenC3 Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.openc3.com/docs/guides/cfs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="COSMOS and NASA cFS | OpenC3 Docs"><meta data-rh="true" name="description" content="Working configuration"><meta data-rh="true" property="og:description" content="Working configuration"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.openc3.com/docs/guides/cfs"><link data-rh="true" rel="alternate" href="https://docs.openc3.com/docs/guides/cfs" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.openc3.com/docs/guides/cfs" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0e9c02bb.css">
<script src="/assets/js/runtime~main.f9ec79e2.js" defer="defer"></script>
<script src="/assets/js/main.dd2c31f3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="OpenC3 Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="OpenC3 Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenC3 Docs</b></a><a href="https://openc3.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home</a><a href="https://openc3.com/enterprise/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Enterprise</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Documentation</a><a href="https://openc3.com/news/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">News</a><a href="https://openc3.com/contact/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contact</a><a href="https://openc3.com/about/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/OpenC3/cosmos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/getting-started">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/configuration">Configuration</a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/tools">Tools</a><button aria-label="Expand sidebar category &#x27;Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/guides">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/bridges">Bridges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/cfs">COSMOS and NASA cFS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/custom-widgets">Custom Widgets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/little-endian-bitfields">Little Endian Bitfields</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/local-mode">Local Mode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/monitoring">Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/performance">Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/raspberrypi">Raspberry Pi</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/script-writing">Script Writing Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/scripting-api">Scripting API Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/meta">Meta</a><button aria-label="Expand sidebar category &#x27;Meta&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/privacy">OpenC3, Inc. Privacy Policy</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/guides"><span itemprop="name">Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">COSMOS and NASA cFS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>COSMOS and NASA cFS</h1></header><h2 id="working-configuration">Working configuration</h2>
<p>This tutorial has been tested using the following components:</p>
<ul>
<li>COSMOS v5 release <a href="https://github.com/OpenC3/cosmos/releases/tag/v5.0.6">5.0.6</a></li>
<li>cFS master-branch commit: 561b128 (June 1, 2022)</li>
<li>Docker Desktop 4.9.0 on Windows</li>
</ul>
<p>Replace all <code>&lt;xxxxxx&gt;</code> with your matching paths and names. Example: <code>&lt;USERNAME&gt;</code>.</p>
<h2 id="setting-up-cosmos">Setting up COSMOS</h2>
<p>Install COSMOS according to the official <a href="/docs/getting-started/installation">installation</a> instructions.</p>
<h3 id="configuring-cosmos">Configuring COSMOS</h3>
<p>Change the Docker configuration for the interoperability with NASA cFS. For
subscribing to the telemetry, you have to append a port binding in the file
<code>compose.yaml</code> under the section <code>openc3-operator</code>. The port number has to
match with the port number cFS is sending the telemetry on.</p>
<pre><code class="language-yaml">openc3-operator:
  ports:
    - &quot;1235:1235/udp&quot;
</code></pre>
<p>Run COSMOS, the first run takes a while (~15 min).</p>
<pre><code class="language-bash">openc3.sh start
</code></pre>
<p>When started, connect with a browser to <a href="http://localhost:2900">http://localhost:2900</a>.</p>
<p>For shutting down COSMOS:</p>
<pre><code class="language-bash">openc3.sh stop
</code></pre>
<h2 id="setting-up-cfs">Setting up cFS</h2>
<p>To run <a href="https://github.com/nasa/cFS">NASA cFS</a> as a Docker container do the following:</p>
<h3 id="clone-cfs">Clone cFS</h3>
<pre><code class="language-bash">git clone --recurse-submodules https://github.com/nasa/cFS.git
</code></pre>
<h3 id="create-dockerfile-in-cfs-dir">Create Dockerfile in cFS dir</h3>
<pre><code class="language-docker">FROM ubuntu:22.10 AS builder

ARG DEBIAN_FRONTEND=noninteractive
ARG SIMULATION=native
ENV SIMULATION=${SIMULATION}
ARG BUILDTYPE=debug
ENV BUILDTYPE=${BUILDTYPE}
ARG OMIT_DEPRECATED=true
ENV OMIT_DEPRECATED=${OMIT_DEPRECATED}

RUN \
  apt-get update &amp;&amp; \
  apt-get -y upgrade &amp;&amp; \
  apt-get install -y build-essential git cmake &amp;&amp; \
  rm -rf /var/lib/apt/lists/*

WORKDIR /cFS
COPY . .

RUN git submodule init \
  &amp;&amp; git submodule update \
  &amp;&amp; cp cfe/cmake/Makefile.sample Makefile \
  &amp;&amp; cp -r cfe/cmake/sample_defs .

RUN make prep
RUN make
RUN make install

FROM ubuntu:22.10
COPY --from=builder /cFS/build /cFS/build
WORKDIR /cFS/build/exe/cpu1
ENTRYPOINT [ &quot;./core-cpu1&quot; ]
</code></pre>
<h3 id="build-and-run-cfs">Build and run cFS</h3>
<p>Note we&#x27;re connecting to the COSMOS network (<code>docker network ls</code>) and exposing the cFS ports.</p>
<pre><code class="language-bash">docker build -t cfs .
docker run --cap-add CAP_SYS_RESOURCE --net=openc3-cosmos-network --name cfs -p1234:1234/udp -p1235:1235 cfs
</code></pre>
<h2 id="creating-a-cosmos-plugin-for-tmtc-interface-with-cfs">Creating a COSMOS plugin for TM/TC interface with cFS</h2>
<p>The detailed instructions how to create a plugin, can be found
<a href="/docs/getting-started/gettingstarted">here</a>, in the chapter &quot;Interfacing with Your Hardware&quot;.</p>
<p>Create a new plugin with the name <code>CFS</code>. <code>CFS</code> is the name of the plugin and
must be in capital letters according to the COSMOS documentation. This command
should create the plugin structure. Then cd into the plugin to create the target.</p>
<pre><code class="language-bash"># cd .. to the location of the cfs dir
$PATH_TO_OPENC3/openc3.sh cli generate plugin CFS
cd openc3-cosmos-cfs
$PATH_TO_OPENC3/openc3.sh cli generate target CFS
</code></pre>
<p>In this newly created plugin, change the <code>plugin.txt</code> file, so that the
communication happens over UDP. <code>port_tm</code> is the port number on which cFS
sends the telemetry messages. <code>port_tc</code> indicates the port on which cFS listens to the
telecommands.</p>
<pre><code class="language-ruby">VARIABLE ip 127.0.0.1
VARIABLE port_tm 1235
VARIABLE port_tc 1234
VARIABLE cfs_target_name CFS

TARGET CFS &lt;%= cfs_target_name %&gt;
# hostname   write_dest_port   read_port   write_src_port   interface_address   ttl   write_timeout   read_timeout   bind_address
INTERFACE &lt;%= cfs_target_name %&gt;_INT udp_interface.rb &lt;%= ip %&gt; &lt;%= port_tc %&gt; &lt;%= port_tm %&gt; nil nil 128 nil nil
  MAP_TARGET &lt;%= cfs_target_name %&gt;
</code></pre>
<p>Note that the two arguments to the <code>TARGET</code> parameter are:</p>
<ol>
<li>
<p>the physical target name that should match the name of the plugin, i.e. <code>CFS</code>.
This name must match the folder name in the <code>targets</code> folder. Example: for the
<code>CFS</code> plugin, the target specifications must be under
<code>openc3-cfs/targets/CFS</code>. If you don&#x27;t follow this
convention, the server will refuse to install your plugin at the following steps.</p>
</li>
<li>
<p>the name of your target and how it is shown in the user interface.</p>
</li>
</ol>
<p>In this example, we keep both names to be <code>CFS</code>.</p>
<h2 id="creating-tmtc-definitions">Creating TM/TC definitions</h2>
<p>Change to the target folder and remove the existing files and create own files.</p>
<pre><code class="language-bash">cd openc3-cfs/targets/CFS/cmd_tlm
rm *
touch cfs_cmds.txt
touch cfs_tlm.txt
touch to_lab_cmds.txt
</code></pre>
<p>Open these newly created files in a text editor and fill them with following
content.</p>
<p><code>to_lab_cmds.txt</code>:</p>
<pre><code class="language-ruby">COMMAND CFS TO_LAB_ENABLE BIG_ENDIAN &quot;Enable telemetry&quot;
  #                   NAME      BITS TYPE   min VAL     max VAL    init VAL  DESCRIPTION
  APPEND_ID_PARAMETER STREAM_ID  16  UINT   0x1880      0x1880     0x1880    &quot;Stream ID&quot;
    FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER    SEQUENCE   16  UINT   0xC000      MAX_UINT16 0xC000    &quot;&quot;
    FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER    PKT_LEN    16  UINT   0x0001      0xFFFF     0x0012    &quot;length of the packet&quot;
  APPEND_PARAMETER    CMD_ID      8  UINT   6           6          6         &quot;&quot;
  APPEND_PARAMETER    CHECKSUM    8  UINT   MIN_UINT8   MAX_UINT8  0x98      &quot;&quot;
    FORMAT_STRING &quot;0x%2X&quot;
  APPEND_PARAMETER    DEST_IP   144  STRING &quot;127.0.0.1&quot;                      &quot;Destination IP, i.e. 172.16.9.112, pc-57&quot;
</code></pre>
<admonition title="Enabling Telemetry" type="info"><p>The command <code>0x1880</code> is needed to enable telemetry. When the cFS receives
this command, it starts sending telemetry to the IP address provided via the
<code>DEST_IP</code> field.</p></admonition>
<p><code>cfs_cmds.txt</code>:</p>
<pre><code class="language-ruby">COMMAND CFS NOOP BIG_ENDIAN &quot;NOOP Command&quot;
  # cFS primary header
  APPEND_ID_PARAMETER    STREAM_ID   16   UINT   0x1882      0x1882      0x1882      &quot;Packet Identification&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       SEQUENCE    16   UINT   MIN_UINT16  MAX_UINT16  0xC000      &quot;&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       PKT_LEN     16   UINT   0x0001      0x0001      0x0001      &quot;Packet length&quot;
  # cFS CMD secondary header
  APPEND_PARAMETER       CMD_ID       8   UINT   0           0           0           &quot;&quot;
  APPEND_PARAMETER       CHECKSUM     8   UINT   MIN_UINT8   MAX_UINT8   MIN_UINT8   &quot;&quot;

COMMAND CFS RESET BIG_ENDIAN &quot;Reset Counters Command&quot;
  APPEND_ID_PARAMETER    STREAM_ID   16   UINT   0x1882      0x1882      0x1882      &quot;Packet Identification&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       SEQUENCE    16   UINT   MIN_UINT16  MAX_UINT16  0xC000      &quot;&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       PKT_LEN     16   UINT   0x0001      0x0001      0x0001      &quot;Packet length&quot;
  APPEND_PARAMETER       CMD_ID       8   UINT   1           1           1           &quot;&quot;
  APPEND_PARAMETER       CHECKSUM     8   UINT   MIN_UINT8   MAX_UINT8   MIN_UINT8   &quot;&quot;

COMMAND CFS PROCESS BIG_ENDIAN &quot;Process Command&quot;
  APPEND_ID_PARAMETER    STREAM_ID   16   UINT   0x1882      0x1882      0x1882      &quot;Packet Identification&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       SEQUENCE    16   UINT   MIN_UINT16  MAX_UINT16  0xC000      &quot;&quot;
      FORMAT_STRING &quot;0x%04X&quot;
  APPEND_PARAMETER       PKT_LEN     16   UINT   0x0001      0x0001      0x0001      &quot;Packet length&quot;
  APPEND_PARAMETER       CMD_ID       8   UINT   2           2           2           &quot;&quot;
  APPEND_PARAMETER       CHECKSUM     8   UINT   MIN_UINT8   MAX_UINT8   MIN_UINT8   &quot;&quot;
</code></pre>
<p><code>cfs_tlm.txt</code>:</p>
<pre><code class="language-ruby">TELEMETRY CFS HK BIG_ENDIAN &quot;housekeeping telemetry&quot;
  #                NAME       BITS  TYPE    ID      DESCRIPTION
  APPEND_ID_ITEM   STREAM_ID   16   UINT    0x0883  &quot;Stream ID&quot;
    FORMAT_STRING &quot;0x%04X&quot;
  APPEND_ITEM      SEQUENCE    16   UINT            &quot;Packet Sequence&quot;
    FORMAT_STRING &quot;0x%04X&quot;
  APPEND_ITEM      PKT_LEN     16   UINT            &quot;Length of the packet&quot;
  # telemetry secondary header
  APPEND_ITEM      SECONDS     32   UINT            &quot;&quot;
        UNITS Seconds sec
  APPEND_ITEM      SUBSECS     16   UINT            &quot;&quot;
        UNITS Milliseconds ms
  # some bytes not known for what
  APPEND_ITEM      SPARE2ALIGN 32   UINT            &quot;Spares&quot;
  # payload
  APPEND_ITEM      CMD_ERRS     8   UINT            &quot;Command Error Counter&quot;
  APPEND_ITEM      CMD_CNT      8   UINT            &quot;Command Counter&quot;
  # spare / alignment
  APPEND_ITEM      SPARE       16   UINT            &quot;Spares&quot;
</code></pre>
<p>Build the plugin from the base of your plugin folder:</p>
<pre><code class="language-bash"># cd openc3-cfs
$PATH_TO_OPENC3/openc3.sh cli rake build VERSION=1.0.0
</code></pre>
<admonition title="Plugin versioning" type="info"><p>Do not forget to change the version number with every build if you want to
better distinguish between the versions of the plugin. When the version is
seen in the plugin&#x27;s .gem file name, it is easier to visualize the existing
versions and the newly uploaded versions.</p></admonition>
<admonition title="Plugin parameters" type="info"><p>Multiple parameters are available for the plugin configuration. See the <a href="/docs/configuration/plugins">plugin</a> page.</p></admonition>
<h2 id="uploading-the-plugin">Uploading the plugin</h2>
<p>After the plugin has been built, you can import the plugin in the admin area of
the page.</p>
<p>Connect with a browser to
<a href="http://localhost:2900/tools/admin">http://localhost:2900/tools/admin</a>.</p>
<p>Click on the clip icon and navigate to where your plugin is stored and select
the <code>openc3-cosmos-cfs-1.0.0.gem</code> file. Right of the selection line click on <code>UPLOAD</code>.</p>
<p>Determine the IP address the cFS container and COSMOS operator container are running at:</p>
<pre><code class="language-bash">docker network ls
NETWORK ID     NAME             DRIVER    SCOPE
d842f813f1c7   openc3-cosmos-network   bridge    local

docker network inspect openc3-cosmos-network
[
    {
        &quot;Name&quot;: &quot;openc3-cosmos-network&quot;,
        ...
        &quot;Containers&quot;: {
            &quot;03cb6bf1b27c631fad1366e9342aeaa5b80f458a437195e4a95e674bb5f5983d&quot;: {
                &quot;Name&quot;: &quot;cfs&quot;,
                &quot;IPv4Address&quot;: &quot;172.20.0.9/16&quot;,
            },
            &quot;ceb9ea99b00849fd8867dcd1646838fef3471f7d64b69014703dbedbcc8147fc&quot;: {
                &quot;Name&quot;: &quot;openc3_openc3-operator_1&quot;,
                &quot;IPv4Address&quot;: &quot;172.20.0.8/16&quot;,
            }
        }
        ...
    }
]
</code></pre>
<p>When using this plugin, make sure to change the <code>ip</code> variable during uploading
to match where cFS is running. In the example above you would set it to 172.20.0.9.
<code>port_tm</code> is the port number on which cFS is sending the telemetry messages.
<code>port_tc</code> indicates the port on cFS is listening for telecommands.</p>
<p>Under <code>cfs_target_name</code> you can change the target name of this plugin. This
step is optional as long as you are fine with your plugin showing up as <code>CFS</code>.</p>
<p><img alt="Plugin Variable Settings" src="/assets/images/plugin_variables-6904e1d9003a6c8c530bd1f738f7966217beca7d3064b40670e7a4ab7e200927.png" width="1183" height="270"></p>
<admonition title="Port subscription" type="warning"><p>The last uploaded plugin on COSMOS will subscribe to TM on port 1235.
Other plugins will not receive any TM anymore.</p></admonition>
<admonition title="Typo errors" type="info"><p>Presence of typos in one of the plugin files can cause problems when uploading and installing
the plugin&#x27;s .gem file. Make sure your configuration is typo-free.</p></admonition>
<p>In the example above, the operator image is running at 172.20.0.8. To enable telemetry, go to the browser and connect to
<a href="http://localhost:2900/tools/cmdsender/CFS/TO_LAB_ENABLE">http://localhost:2900/tools/cmdsender/CFS/TO_LAB_ENABLE</a>. Change the <code>DEST_IP</code> to the IP address of the operator image (172.20.0.8) and send the command.</p>
<p>Under <a href="http://localhost:2900/tools/cmdtlmserver/tlm-packets">http://localhost:2900/tools/cmdtlmserver/tlm-packets</a>, you should see the incoming packets. Note in the CmdTlmServer you will also see CFS_INT UNKNOWN packets because we did not define the full cFS packet set. That exercise is left to the reader.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/OpenC3/cosmos/tree/main/docs.openc3.com/docs/guides/cfs.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guides/bridges"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bridges</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/guides/custom-widgets"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Custom Widgets</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#working-configuration" class="table-of-contents__link toc-highlight">Working configuration</a></li><li><a href="#setting-up-cosmos" class="table-of-contents__link toc-highlight">Setting up COSMOS</a><ul><li><a href="#configuring-cosmos" class="table-of-contents__link toc-highlight">Configuring COSMOS</a></li></ul></li><li><a href="#setting-up-cfs" class="table-of-contents__link toc-highlight">Setting up cFS</a><ul><li><a href="#clone-cfs" class="table-of-contents__link toc-highlight">Clone cFS</a></li><li><a href="#create-dockerfile-in-cfs-dir" class="table-of-contents__link toc-highlight">Create Dockerfile in cFS dir</a></li><li><a href="#build-and-run-cfs" class="table-of-contents__link toc-highlight">Build and run cFS</a></li></ul></li><li><a href="#creating-a-cosmos-plugin-for-tmtc-interface-with-cfs" class="table-of-contents__link toc-highlight">Creating a COSMOS plugin for TM/TC interface with cFS</a></li><li><a href="#creating-tmtc-definitions" class="table-of-contents__link toc-highlight">Creating TM/TC definitions</a></li><li><a href="#uploading-the-plugin" class="table-of-contents__link toc-highlight">Uploading the plugin</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Homepage</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://openc3.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Home</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/openc3" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/OpenC3/cosmos" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/privacy">Privacy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OpenC3, Inc.</div></div></div></footer></div>
</body>
</html>